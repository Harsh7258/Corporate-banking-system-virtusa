<div class="credit-requests-container">
  
  <!-- Page Header -->
  <div class="page-header">
    <h1>Credit Requests</h1>
    <p>View and track all your credit requests</p>
  </div>

  <!-- Credit Requests Table Card -->
  <mat-card class="table-card">
    <div class="table-header">
      <h2>All Credit Requests</h2>
      <button mat-raised-button color="primary" class="refresh-btn" (click)="loadCreditRequests()">
        <mat-icon>refresh</mat-icon>
        Refresh
      </button>
    </div>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="loading">
      <div class="spinner"></div>
      <p>Loading credit requests...</p>
    </div>

    <!-- Table -->
    <div class="table-wrapper" *ngIf="!loading">
      <table mat-table [dataSource]="creditRequests" class="credit-table">

        <!-- Client Name Column -->
        <ng-container matColumnDef="clientName">
          <th mat-header-cell *matHeaderCellDef>Client Name</th>
          <td mat-cell *matCellDef="let request">
            <div class="client-cell">
              <mat-icon class="client-icon">business</mat-icon>
              <span class="client-name">{{ request.clientName || 'N/A' }}</span>
            </div>
          </td>
        </ng-container>

        <!-- Request Amount Column -->
        <ng-container matColumnDef="requestAmount">
          <th mat-header-cell *matHeaderCellDef>Request Amount</th>
          <td mat-cell *matCellDef="let request">
            <span class="amount">{{ formatCurrency(request.requestAmount) }}</span>
          </td>
        </ng-container>

        <!-- Tenure Months Column -->
        <ng-container matColumnDef="tenureMonths">
          <th mat-header-cell *matHeaderCellDef>Tenure</th>
          <td mat-cell *matCellDef="let request">
            <div class="tenure-cell">
              <mat-icon class="tenure-icon">schedule</mat-icon>
              <span>{{ request.tenureMonths }} months</span>
            </div>
          </td>
        </ng-container>

        <!-- Purpose Column -->
        <ng-container matColumnDef="purpose">
          <th mat-header-cell *matHeaderCellDef>Purpose</th>
          <td mat-cell *matCellDef="let request">
            <span class="purpose" [title]="request.purpose">
              {{ request.purpose.length > 50 ? (request.purpose | slice:0:50) + '...' : request.purpose }}
            </span>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let request">
            <mat-chip [class]="getStatusClass(request.status)">
              {{ request.status || 'PENDING' }}
            </mat-chip>
          </td>
        </ng-container>

        <!-- Remarks Column -->
        <ng-container matColumnDef="remarks">
          <th mat-header-cell *matHeaderCellDef>Remarks</th>
          <td mat-cell *matCellDef="let request">
            <span class="remarks" *ngIf="request.remarks; else noRemarks">
              {{ request.remarks }}
            </span>
            <ng-template #noRemarks>
              <span class="no-remarks">â€”</span>
            </ng-template>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-row"></tr>

        <!-- No Data -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell no-data" [attr.colspan]="displayedColumns.length">
            <mat-icon>info</mat-icon>
            <p>No credit requests found. Create your first credit request from the dashboard.</p>
          </td>
        </tr>

      </table>
    </div>
  </mat-card>

</div>
